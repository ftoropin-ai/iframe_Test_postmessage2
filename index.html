<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Iframe Logger —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #controls { margin-bottom: 15px; }
    button { margin-right: 10px; padding: 5px 10px; }
    #log { border: 1px solid #ccc; padding: 10px; height: 200px; overflow-y: auto; }
  </style>
</head>
<body>
  <h1>–õ–æ–≥ —Å–æ–æ–±—â–µ–Ω–∏–π (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π)</h1>

  <div id="controls">
    <button data-filter="all">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å—ë</button>
    <button data-filter="mute">–¢–æ–ª—å–∫–æ mute</button>
    <button data-filter="unmute">–¢–æ–ª—å–∫–æ unmute</button>
  </div>

  <div id="log">–ñ–¥—É —Å–æ–æ–±—â–µ–Ω–∏—è...</div>

  <script>
    const logDiv = document.getElementById("log");
    let currentFilter = "all";

    // –ú–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä –ø–æ –∫–ª–∏–∫—É –Ω–∞ –∫–Ω–æ–ø–∫—É
    document.querySelectorAll("#controls button").forEach(btn => {
      btn.addEventListener("click", () => {
        currentFilter = btn.getAttribute("data-filter");
        const p = document.createElement("p");
        p.textContent = `üîÑ –§–∏–ª—å—Ç—Ä –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω: ${currentFilter}`;
        p.style.fontStyle = "italic";
        logDiv.appendChild(p);
      });
    });

    // –°–ª—É—à–∞–µ–º –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    window.addEventListener("message", (event) => {
      try {
        const msg = typeof event.data === "string" ? JSON.parse(event.data) : event.data;

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Ñ–∏–ª—å—Ç—Ä—É
        if (currentFilter === "all" || msg.type === currentFilter) {
          const p = document.createElement("p");
          p.textContent = `–°–æ–±—ã—Ç–∏–µ: ${msg.type} | –î–∞–Ω–Ω—ã–µ: ${JSON.stringify(msg.data)}`;
          logDiv.appendChild(p);
        }
      } catch (e) {
        console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è:", e);
      }
    });
  </script>
</body>
</html>
